<!--
  @description       : 
  @author            : ChangeMeIn@UserSettingsUnder.SFDoc
  @group             : 
  @last modified on  : 10-14-2021
  @last modified by  : ChangeMeIn@UserSettingsUnder.SFDoc
-->
<apex:page controller="ObjectsAndFieldsAccess" cache="true" sidebar="false" showHeader="true" docType="HTML-5.0" standardStylesheets="false" lightningStyleSheets="true">
	 <apex:outputPanel rendered="{!hasAccess}">
	<head>
		<title>Objects and Fields Access</title>
         <!-- <link href="https://maxst.icons8.com/vue-static/landings/line-awesome/line-awesome/1.3.0/css/line-awesome.min.css" rel="stylesheet"/> -->
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<apex:includeScript value="{!URLFOR($Resource.jQuery, 'jQuery/jquery.min.js')}"/>
		<apex:includeScript value="{!URLFOR($Resource.jQuery, 'jQuery/bootstrap/bootstrap.min.js')}"/>
		<apex:slds />
	</head>
	<style type="text/css">
        .scrollable-panel {
                
        overflow-y: auto;          
         
        padding: 5px;               
        display: block;             
        max-width: 100%;            
    }
        .hidden-input {
    display: none; /* The element will not take up any space */
    visibility: hidden; /* The element will not be visible */
}
		
        .custPopup{
			background-color: white;
			border-width: 2px;
			border-style: solid;
			z-index: 9999;
			left: 50%;
			padding:20px;
			position: fixed;
			font-size: 100%;
			/* These are the 3 css properties you will need to change so the popup 
			displays in the center of the screen. First set the width. Then set 
			margin-left to negative half of what the width is. You can add 
			the height property for a fixed size pop up if you want.*/
			width: 600px;
			margin-left: -250px;
			top:100px;
		}
		.popupBackground{
			background-color:black;
			opacity: 0.20;
			filter: alpha(opacity = 20);
			position: absolute;
			width: 100%;
			height: 100%;
			top: 0;
			left: 0;
			z-index: 9998;
		}
        body button:hover,body .btn:hover,body .btnCancel:hover,body .menuButton .menuButtonButton:hover { background-position:right 0px; background-color: #f3f4f6; box-shadow: -1px 2px 5px rgba(81,41,10,0.15),0px 1px 1px rgba(81,41,10,0.15);  transform: translateY(0.125rem);   }
        
         body button:focus,body .btn:focus,body .btnCancel:focus,body .menuButton .menuButtonButton:focus {
        box-shadow: rgba(72, 35, 7, .46) 0 0 0 4px, -6px 8px 10px rgba(81,41,10,0.1), 0px 2px 2px rgba(81,41,10,0.2);
        }
      

	</style>


	
	<body>
		<apex:form id="theForm" >
           <apex:outputPanel id="errorSection" styleClass="scrollable-panel">
    <apex:pageMessages />
</apex:outputPanel>
<apex:outputPanel >
		<div class="slds-scope" style=" margin:15px;">
		
			<div class="demo-only demo-only--sizing slds-grid slds-wrap">
                    <div class="slds-p-horizontal_small slds-size_1-of-1">
                        <div class="slds-scope">
                    <div class="slds-form-element">
                       <table class="slds-table slds-table_bordered" width="100%">
                            <thead>
                                <tr>
                                    <!-- Logo Column -->
                                    <th style="text-align: left; background-color: transparent; width: 15%;">
                                        <div class="slds-truncate" title="Application Perfection">
                                            <apex:image id="theLogoImage" value="{!$Resource.logoApplicationPerfection}" width="200" height="20"/>
                                        </div>
                                    </th>
                                    
                                    <!-- Description Column -->
                                    <th style="background-color: transparent; text-align: left;">
                                        <div class="slds-truncate">
                                            <h2>
                                                Review and update how permission sets and profiles are applied to objects. 
                                            </h2>
                                        </div>
                                    </th>
                                    
                                    <!-- Button Group Column -->
                                    <th style="background-color: transparent; width: 35%;">
                                        <div style="display: flex; justify-content: flex-end; flex-wrap: wrap; gap: 8px;">
                                            <apex:commandLink value="Help/Training" action="{!openHelpTraining}"  immediate="true" target="_blank" style="text-decoration:none; border: none;width: 180px;justify-content: center; appearance: button; background-color: #8694f4;background-image: linear-gradient(to bottom, #fff, #eceae787);border: 1px solid #d4d2d2;border-radius: 0.5rem;box-sizing: border-box;color: #444444;column-gap: 1rem;cursor: pointer;display: flex;font-family: ui-sans-serif,system-ui,-apple-system,system-ui,&quot;Segoe UI&quot;,Roboto,&quot;Helvetica Neue&quot;,Arial,&quot;Noto Sans&quot;,sans-serif,&quot;Apple Color Emoji&quot;,&quot;Segoe UI Emoji&quot;,&quot;Segoe UI Symbol&quot;,&quot;Noto Color Emoji&quot;;font-size: 100%;flex: 1;font-weight: 700;line-height: 13px;margin: 3px;outline: 2px solid transparent;padding: 0.6rem 1.5rem;text-align: center;text-transform: none;transition: all .1s cubic-bezier(.4, 0, .2, 1);-webkit-user-select: none;-moz-user-select: none;-ms-user-select: none;user-select: none;touch-action: manipulation;box-shadow: -6px 8px 10px rgb(81 41 10 / 11%), 0 2px 2px rgb(81 41 10 / 10%);" styleClass="slds-button slds-button--brand slds-not-selected"/>
                                            <apex:commandLink value="FAQ's" action="{!openFAQ}"  immediate="true" target="_blank" style="text-decoration:none; border: none;width: 180px;justify-content: center; appearance: button; background-color: #8694f4;background-image: linear-gradient(to bottom, #fff, #eceae787);border: 1px solid #d4d2d2;border-radius: 0.5rem;box-sizing: border-box;color: #444444;column-gap: 1rem;cursor: pointer;display: flex;font-family: ui-sans-serif,system-ui,-apple-system,system-ui,&quot;Segoe UI&quot;,Roboto,&quot;Helvetica Neue&quot;,Arial,&quot;Noto Sans&quot;,sans-serif,&quot;Apple Color Emoji&quot;,&quot;Segoe UI Emoji&quot;,&quot;Segoe UI Symbol&quot;,&quot;Noto Color Emoji&quot;;font-size: 100%;flex: 1;font-weight: 700;line-height: 13px;margin: 3px;outline: 2px solid transparent;padding: 0.6rem 1.5rem;text-align: center;text-transform: none;transition: all .1s cubic-bezier(.4, 0, .2, 1);-webkit-user-select: none;-moz-user-select: none;-ms-user-select: none;user-select: none;touch-action: manipulation;box-shadow: -6px 8px 10px rgb(81 41 10 / 11%), 0 2px 2px rgb(81 41 10 / 10%);" styleClass="slds-button slds-button--brand slds-not-selected"/>
                                            <apex:commandLink value="Request a feature/support" action="{!openContactUSLink}"  immediate="true" target="_blank" style="text-decoration:none; border: none;width: 180px;justify-content: center; appearance: button; background-color: #8694f4;background-image: linear-gradient(to bottom, #fff, #eceae787);border: 1px solid #d4d2d2;border-radius: 0.5rem;box-sizing: border-box;color: #444444;column-gap: 1rem;cursor: pointer;display: flex;font-family: ui-sans-serif,system-ui,-apple-system,system-ui,&quot;Segoe UI&quot;,Roboto,&quot;Helvetica Neue&quot;,Arial,&quot;Noto Sans&quot;,sans-serif,&quot;Apple Color Emoji&quot;,&quot;Segoe UI Emoji&quot;,&quot;Segoe UI Symbol&quot;,&quot;Noto Color Emoji&quot;;font-size: 100%;flex: 1;font-weight: 700;line-height: 13px;margin: 3px;outline: 2px solid transparent;padding: 0.6rem 1.5rem;text-align: center;text-transform: none;transition: all .1s cubic-bezier(.4, 0, .2, 1);-webkit-user-select: none;-moz-user-select: none;-ms-user-select: none;user-select: none;touch-action: manipulation;box-shadow: -6px 8px 10px rgb(81 41 10 / 11%), 0 2px 2px rgb(81 41 10 / 10%);" styleClass="slds-button slds-button--brand slds-not-selected"/>
                                            <apex:commandLink value="Release Notes" action="{!openReleaseNotes}"  immediate="true" target="_blank" style="text-decoration:none; border: none;width: 180px;justify-content: center; appearance: button; background-color: #8694f4;background-image: linear-gradient(to bottom, #fff, #eceae787);border: 1px solid #d4d2d2;border-radius: 0.5rem;box-sizing: border-box;color: #444444;column-gap: 1rem;cursor: pointer;display: flex;font-family: ui-sans-serif,system-ui,-apple-system,system-ui,&quot;Segoe UI&quot;,Roboto,&quot;Helvetica Neue&quot;,Arial,&quot;Noto Sans&quot;,sans-serif,&quot;Apple Color Emoji&quot;,&quot;Segoe UI Emoji&quot;,&quot;Segoe UI Symbol&quot;,&quot;Noto Color Emoji&quot;;font-size: 100%;flex: 1;font-weight: 700;line-height: 13px;margin: 3px;outline: 2px solid transparent;padding: 0.6rem 1.5rem;text-align: center;text-transform: none;transition: all .1s cubic-bezier(.4, 0, .2, 1);-webkit-user-select: none;-moz-user-select: none;-ms-user-select: none;user-select: none;touch-action: manipulation;box-shadow: -6px 8px 10px rgb(81 41 10 / 11%), 0 2px 2px rgb(81 41 10 / 10%);" styleClass="slds-button slds-button--brand slds-not-selected"/>
                                        </div>
                                    </th>
                                    
                                    <!-- Security Logo -->
                                    <th style="text-align: right; width: 10%; background-color: transparent;">
                                        <div class="slds-truncate" title="Security & Access Manager">
                                            <apex:image id="theImage" value="{!$Resource.logo}" width="150" height="20"/>
                                        </div>
                                    </th>
                                </tr>
                            </thead>
                        </table>
                            </div>
                        </div>
                    </div>
                </div>
			
				
			<apex:outputPanel rendered="{!isAccessible}" id="selectOptions" styleClass="selectOptions2">
				<div class="demo-only demo-only--sizing slds-grid slds-wrap">
					<div class="slds-size_1-of-1 slds-medium-size--1-of-1 slds-large-size--1-of-2" style="width: 45%;">
						<Strong>Type of permissions</Strong> &nbsp;
						<apex:selectList value="{!selectedPerm}" size="1" styleClass="slds-select">
							<apex:selectOptions value="{!PermissionType}"/>
							<apex:actionSupport event="onchange" rerender="selectOptions, profilesTable,errorSection, selectLog, buttonSection" action="{!changeType}" status="tableStatus"/>
						</apex:selectList>
                        
                        <Strong>All PermissionSetGroups</Strong> &nbsp;
						<apex:selectList value="{!AllPSetGrp}" size="1" styleClass="slds-select">
							<apex:selectOptions value="{!PermissionGrpType}"/>
							<apex:actionSupport event="onchange" rerender="selectOptions, profilesTable,errorSection, selectLog, buttonSection" action="{!changePsetGrp}" status="tableStatus"/>
						</apex:selectList> <!-- -->
                        
                           
                        <c:MultiselectPicklist leftLabel="Available Profiles/Permission Sets."
                                               leftOption="{!remainingProfiles}"
                                               leftOption1="{!remainingProfiles1}"
                                               rightLabel="Selected Profiles/Permission Sets"
                                               rightOption="{!selectedProfiles}"
                                               size="100"
                                               width="200px"
                                               id="multiSelectList"/>
                        <!-- Main div of object template  -->
                        <div id="conditionalDiv">
                            <div id="subDiv" style="display: block;    padding: 10px;">
                                <!-- Button to Save Selection -->
                                <apex:commandButton value="Save Selection"  status="tableStatus" onclick="OAFstoreOptionsInLocalStorage(); return false;" />
                                
                                <!-- Help Icon with Tooltip -->
                                <span class="help-icon" onmouseover="showTooltip(event)" onmouseout="hideTooltip(event)">
                                    &#9432; <!-- Unicode character for information symbol -->
                                </span>
                                
                                <!-- Tooltip Container -->
                                <div class="tooltip" id="helpTooltip" style="display: none;"> <!-- Add style to hide tooltip by default -->
                                    <p>Clicking 'Save Selection' will save your current selections to the storage for future use.</p>
                                    <p><strong>How to Save Your Selection:</strong></p> 
                                    <ul>
                                        <li><strong>Step 1:</strong> Choose profiles from the list.</li>
                                        <li><strong>Step 2:</strong> Add the selected profiles to the right box.</li>
                                        <li><strong>Step 3:</strong> Click the <em>'Save Selection'</em> button. You're all set!</li>
                                    </ul>
                                </div>
                            </div>
                            <div id="subDiv2">
                                <!-- Dropdown to Select a Template-->
                                <select id="templateDropdownOAF" onchange="OAFloadTemplateOptions(this.value);">
                                    <option value="">Select a template</option>
                                </select> 
                                
                                <!-- Additional Buttons -->
                                <apex:commandButton value="Refresh" onclick="OAFsyncSelectOptions()" />
                                <apex:commandButton value="Delete" onclick="OAFDeleteSelectOptions()" />
                                
                                <!-- Hidden OutputText for Storing Data -->
                                <apex:outputText value="{!$Component.hiddenSelectedProfiles}" id="hiddenInputIdText" />
                            </div>
                        </div>
                        
                        
                        
                        <!-- <div>
                            <select id="templateDropdown"   onchange="loadTemplateOptions(this.value);">
                                <option value="">Select a template</option>
                            </select>
                            <apex:commandButton value="Refresh" onclick="syncSelectOptions()" />
                            <apex:commandButton value="Delete" onclick="DeleteSelectOptions()" />
                            
                            <apex:outputText value="{!$Component.hiddenSelectedProfiles}" id="hiddenInputIdText"  />
                            
                        </div> -->
                        <div style="margin: 7px;">
                            <span style="padding: 3px; border-radius: 4px; color: white;  background: grey; font-size: 1.1em; font-weight: 500;">Select up to 7 Permissions to display on the page. </span>  <!--But select as many permissions as you need when creating a template. This template will be available upon pressing export to Excel button.  -->
                        </div>
					</div>
					<div class="slds-size_1-of-1 slds-medium-size--1-of-1 slds-large-size--1-of-2" style="    width: 49%; position: relative;left: 6%;">
						<strong>Type of object</strong> &nbsp;
						<apex:selectList value="{!selectedType}" size="1" styleClass="slds-select">
							<apex:selectOptions value="{!objectsType}"/>
							<apex:actionSupport event="onchange" rerender="theForm" action="{!changeType}" status="tableStatus"/>
						</apex:selectList>
                        
                      
                        
                        <div   style="    position: relative;   top: 42px;"> 
						 <c:multiselectpicklistobjdesc leftLabel="Available Objects"
							leftOption="{!remainingObjects}"
							leftOption1="{!remainingObjects1}"
							rightLabel="Selected Objects"
							rightOption="{!selectedObjects}"
							size="6"
							width="200px"/>  
                            <!-- <div>
                                        <select id="templateDropdown"   onchange="loadTemplateOptions(this.value);">
                                            <option value="">Select a template</option>
                                        </select>
                                        <apex:commandButton value="Refresh" onclick="syncSelectOptions()" />
                                       <apex:commandButton value="Delete" onclick="DeleteSelectOptions()" />
                                   
                                       <apex:outputText value="{!$Component.hiddenSelectedProfiles}" id="hiddenInputIdText"  />
                                        
                                    </div> -->
                             
                            
                        </div>
					</div>
				</div>
			</apex:outputPanel>
			<br/>
            <apex:outputPanel id="selectLog" rendered="{!isAccessible && canChange}" styleClass="otherClass">
				<apex:outputPanel rendered="{!expandObject != '' && expandObject != null}">
					<div class="demo-only demo-only--sizing slds-grid slds-wrap">
						<div class="slds-p-horizontal_small slds-size_1-of-1">
							<table width="100%">
								<tr>
									
									<td style="text-align: left; padding-right: 30px;">
                                        <strong> Please select a saved log </strong>&nbsp;
										<apex:selectList value="{!selectedLog}" size="1" styleClass="slds-select">
											<apex:selectOptions value="{!optionsLog}"/>
											<apex:actionSupport event="onchange" rerender="selectOptions, profilesTable,errorSection, selectLog, buttonSection" action="{!changeLog}" status="tableStatus"/>
										</apex:selectList>
									</td>
                                    <td style="padding-left: 5%;">
                                        <strong> Description of change </strong>&nbsp;&nbsp;<br/>
										<apex:inputTextarea id="newDesc" value="{!description}" rows="1" style="width: 400px;" styleClass="slds-input"/>
									</td>
								</tr>
							</Table>
						</div>
					</div>
				</apex:outputPanel>
			</apex:outputPanel>
			<br/>
			<apex:outputPanel layout="none" id="buttonSection" rendered="{!isAccessible}" styleClass="buts" >
				<div style="display:flex; justify-content: end;" class="buts">
					<div   style="padding-left: 10px"  class="buts">
						<apex:commandButton action="{!Go}" value="Go" oncomplete="OAFsyncSelectOptions()" rerender="multiSelectList,profilesTable,errorSection,templateDropdownOAF, selectOptions, selectLog" status="tableStatus" styleClass="selectOptions2" style=" width: 140px;height: 45px; justify-content: center; appearance: button; background-color: #8694f4;background-image: linear-gradient(to bottom, #fff, #eceae787);border: 1px solid #d4d2d2;border-radius: 0.5rem;box-sizing: border-box;color: #444444;column-gap: 1rem;cursor: pointer;display: flex;font-family: ui-sans-serif,system-ui,-apple-system,system-ui,&quot;Segoe UI&quot;,Roboto,&quot;Helvetica Neue&quot;,Arial,&quot;Noto Sans&quot;,sans-serif,&quot;Apple Color Emoji&quot;,&quot;Segoe UI Emoji&quot;,&quot;Segoe UI Symbol&quot;,&quot;Noto Color Emoji&quot;;font-size: 100%;flex: 1;font-weight: 700;line-height: 13px;margin: 3px;outline: 2px solid transparent;padding: 0.6rem 1.5rem;text-align: center;text-transform: none;transition: all .1s cubic-bezier(.4, 0, .2, 1);-webkit-user-select: none;-moz-user-select: none;-ms-user-select: none;user-select: none;touch-action: manipulation;box-shadow: -6px 8px 10px rgb(81 41 10 / 11%), 0 2px 2px rgb(81 41 10 / 10%);" id="goId"/>
					</div>
					<div  style="padding-left: 10px"  class="buts">
						<apex:commandButton action="{!Save}" value="Save" rerender="profilesTable,errorSection, selectLog" status="tableStatus"  style=" width: 140px;height: 45px; justify-content: center; appearance: button; background-color: #8694f4;background-image: linear-gradient(to bottom, #fff, #eceae787);border: 1px solid #d4d2d2;border-radius: 0.5rem;box-sizing: border-box;color: #444444;column-gap: 1rem;cursor: pointer;display: flex;font-family: ui-sans-serif,system-ui,-apple-system,system-ui,&quot;Segoe UI&quot;,Roboto,&quot;Helvetica Neue&quot;,Arial,&quot;Noto Sans&quot;,sans-serif,&quot;Apple Color Emoji&quot;,&quot;Segoe UI Emoji&quot;,&quot;Segoe UI Symbol&quot;,&quot;Noto Color Emoji&quot;;font-size: 100%;flex: 1;font-weight: 700;line-height: 13px;margin: 3px;outline: 2px solid transparent;padding: 0.6rem 1.5rem;text-align: center;text-transform: none;transition: all .1s cubic-bezier(.4, 0, .2, 1);-webkit-user-select: none;-moz-user-select: none;-ms-user-select: none;user-select: none;touch-action: manipulation;box-shadow: -6px 8px 10px rgb(81 41 10 / 11%), 0 2px 2px rgb(81 41 10 / 10%);" rendered="{!selectedLog == '' && canChange}" styleClass="slds-button slds-button_succes selectOptions2s"/>
						<apex:commandButton action="{!RevertChanges}" status="tableStatus" rerender="profilesTable, errorSection" value="Revert Changes" style=" width: 150px;height: 45px; justify-content: center; appearance: button; background-color: #8694f4;background-image: linear-gradient(to bottom, #fff, #eceae787);border: 1px solid #d4d2d2;border-radius: 0.5rem;box-sizing: border-box;color: #444444;column-gap: 1rem;cursor: pointer;display: flex;font-family: ui-sans-serif,system-ui,-apple-system,system-ui,&quot;Segoe UI&quot;,Roboto,&quot;Helvetica Neue&quot;,Arial,&quot;Noto Sans&quot;,sans-serif,&quot;Apple Color Emoji&quot;,&quot;Segoe UI Emoji&quot;,&quot;Segoe UI Symbol&quot;,&quot;Noto Color Emoji&quot;;font-size: 100%;flex: 1;font-weight: 700;line-height: 13px;margin: 3px;outline: 2px solid transparent;padding: 0.6rem 1.5rem;text-align: center;text-transform: none;transition: all .1s cubic-bezier(.4, 0, .2, 1);-webkit-user-select: none;-moz-user-select: none;-ms-user-select: none;user-select: none;touch-action: manipulation;box-shadow: -6px 8px 10px rgb(81 41 10 / 11%), 0 2px 2px rgb(81 41 10 / 10%);" rendered="{!selectedLog != '' && selectedLog != null && canChange}" styleClass="slds-button slds-button_success selectOptions2"/>
					</div>
					<div   style="padding-left: 10px"  class="buts">
						<apex:commandButton action="{!ExportToExcel}" value="Export To Excel" status="tableStatus" style="width: 140px;height: 45px; justify-content: center; appearance: button; background-color: #8694f4;background-image: linear-gradient(to bottom, #fff, #eceae787);border: 1px solid #d4d2d2;border-radius: 0.5rem;box-sizing: border-box;color: #444444;column-gap: 1rem;cursor: pointer;display: flex;font-family: ui-sans-serif,system-ui,-apple-system,system-ui,&quot;Segoe UI&quot;,Roboto,&quot;Helvetica Neue&quot;,Arial,&quot;Noto Sans&quot;,sans-serif,&quot;Apple Color Emoji&quot;,&quot;Segoe UI Emoji&quot;,&quot;Segoe UI Symbol&quot;,&quot;Noto Color Emoji&quot;;font-size: 100%;flex: 1;font-weight: 700;line-height: 13px;margin: 3px;outline: 2px solid transparent;padding: 0.6rem 1.5rem;text-align: center;text-transform: none;transition: all .1s cubic-bezier(.4, 0, .2, 1);-webkit-user-select: none;-moz-user-select: none;-ms-user-select: none;user-select: none;touch-action: manipulation;box-shadow: -6px 8px 10px rgb(81 41 10 / 11%), 0 2px 2px rgb(81 41 10 / 10%);" rendered="{!expandObject == '' || selectedLog != ''}" id="excelbutton" styleClass="slds-button selectOptions2  slds-button--brand"/>
						<apex:commandButton action="{!yesPopUp}" value="Select Permissions for Export to Excel" style="text-decoration:none;width: 247px;height: 45px; justify-content: center; appearance: button; background-color: #8694f4;background-image: linear-gradient(to bottom, #fff, #eceae787);border: 1px solid #d4d2d2;border-radius: 0.5rem;box-sizing: border-box;color: #444444;column-gap: 1rem;cursor: pointer;display: flex;font-family: ui-sans-serif,system-ui,-apple-system,system-ui,&quot;Segoe UI&quot;,Roboto,&quot;Helvetica Neue&quot;,Arial,&quot;Noto Sans&quot;,sans-serif,&quot;Apple Color Emoji&quot;,&quot;Segoe UI Emoji&quot;,&quot;Segoe UI Symbol&quot;,&quot;Noto Color Emoji&quot;;font-size: 100%;flex: 1;font-weight: 700;line-height: 13px;margin: 3px;outline: 2px solid transparent;padding: 0.6rem 1.5rem;text-align: center;text-transform: none;transition: all .1s cubic-bezier(.4, 0, .2, 1);-webkit-user-select: none;-moz-user-select: none;-ms-user-select: none;user-select: none;touch-action: manipulation;box-shadow: -6px 8px 10px rgb(81 41 10 / 11%), 0 2px 2px rgb(81 41 10 / 10%);" reRender="tstpopup, errorMessage" status="tableStatus" rendered="{!expandObject != '' && expandObject != null && selectedLog == ''}" styleClass=" selectOptions2 slds-button slds-button--brand"/>
					</div>
					<div  style="padding-left:10px"  class="buts">
						<!-- <apex:commandButton action="{!printPDF}" value="PDF" status="tableStatus" style="width: 180px;"/> -->
						<apex:commandLink value="Generate PDF" action="{!printPDF}" immediate="true" target="_blank"  style="text-decoration:none;  width: 140px;height: 45px; justify-content: center; appearance: button; background-color: #8694f4;background-image: linear-gradient(to bottom, #fff, #eceae787);border: 1px solid #d4d2d2;border-radius: 0.5rem;box-sizing: border-box;color: #444444;column-gap: 1rem;cursor: pointer;display: flex;font-family: ui-sans-serif,system-ui,-apple-system,system-ui,&quot;Segoe UI&quot;,Roboto,&quot;Helvetica Neue&quot;,Arial,&quot;Noto Sans&quot;,sans-serif,&quot;Apple Color Emoji&quot;,&quot;Segoe UI Emoji&quot;,&quot;Segoe UI Symbol&quot;,&quot;Noto Color Emoji&quot;;font-size: 100%;flex: 1;font-weight: 700;margin: 3px;outline: 2px solid transparent;padding: 0.6rem 1.5rem;text-align: center;text-transform: none;transition: all .1s cubic-bezier(.4, 0, .2, 1);-webkit-user-select: none;-moz-user-select: none;-ms-user-select: none;user-select: none;touch-action: manipulation;box-shadow: -6px 8px 10px rgb(81 41 10 / 11%), 0 2px 2px rgb(81 41 10 / 10%);" styleClass="slds-button slds-button--brand selectOptions2">
							<apex:param name="isPdf" value="true" assignTo="{!isPdf}"/>
						</apex:commandLink>
					</div>
					<!-- <div   style="padding-left: 10px"  class="buts">
						<apex:commandButton action="{!ExportToXML}" value="Export To XML" status="tableStatus" styleClass="slds-button slds-button--brand selectOptions2"  style=" width: 140px;height:45px; justify-content: center; appearance: button; background-color: #8694f4;background-image: linear-gradient(to bottom, #fff, #eceae787);border: 1px solid #d4d2d2;border-radius: 0.5rem;box-sizing: border-box;color: #444444;column-gap: 1rem;cursor: pointer;display: flex;font-family: ui-sans-serif,system-ui,-apple-system,system-ui,&quot;Segoe UI&quot;,Roboto,&quot;Helvetica Neue&quot;,Arial,&quot;Noto Sans&quot;,sans-serif,&quot;Apple Color Emoji&quot;,&quot;Segoe UI Emoji&quot;,&quot;Segoe UI Symbol&quot;,&quot;Noto Color Emoji&quot;;font-size: 100%;flex: 1;font-weight: 700;line-height: 13px;margin: 3px;outline: 2px solid transparent;padding: 0.6rem 1.5rem;text-align: center;text-transform: none;transition: all .1s cubic-bezier(.4, 0, .2, 1);-webkit-user-select: none;-moz-user-select: none;-ms-user-select: none;user-select: none;touch-action: manipulation;box-shadow: -6px 8px 10px rgb(81 41 10 / 11%), 0 2px 2px rgb(81 41 10 / 10%);" id="xmlId" />
					</div> -->
				</div>
				<br/>
			</apex:outputPanel>
			
			<apex:actionStatus id="tableStatus" layout="block" rendered="{!isAccessible}">
				<apex:facet name="start">
					<p >
                         
						<div class="slds-spinner_container slds-is-fixed">
							<div role="status" class="slds-spinner slds-spinner_large slds-spinner_brand">
								<span class="slds-assistive-text">Loading</span>
								<div class="slds-spinner__dot-a"></div>
								<div class="slds-spinner__dot-b"></div>
							</div>
						</div>
                    				</p>
				</apex:facet>
				<apex:facet name="stop"></apex:facet>
			</apex:actionStatus>
            <a href="javascript:void(0);" onclick="expandForm();" class="expand-link" style="text-decoration:none">
                <i class="la la-expand expand-icon" title="Filters(Hide/Show)"></i> Filters(Hide/Show)
            </a>
	<!-- ----------------- Field Permission Table  ------------- -->
			<apex:outputPanel id="profilesTable" rendered="{!isAccessible}">
				<apex:outputPanel rendered="{!selectedLog == ''}">
					<div class="demo-only demo-only--sizing slds-grid slds-wrap">
						<div class="slds-scrollable_x" style="height: 100%; width: 100%;">
							<div class="slds-p-horizontal_small slds-size_1-of-1">
								<apex:variable value="{!IF(selectedProfileIdList.size > 4, 100, 100)}" var="wid"/>
								<apex:variable value="{!IF(selectedProfileIdList.size > 4, 20, 20)}" var="widField"/>
								<apex:variable value="{!IF(selectedProfileIdList.size > 5 , 100, wid)}" var="wid"/>
								<apex:variable value="{!IF(selectedProfileIdList.size > 4, 20, widField)}" var="widField"/>
								<div class="slds-table--header-fixed_container" style="height:60%; padding-top: {!IF(expandObject == '', 3 , 6)}rem; width: {!wid}%">
									<div class="slds-scrollable_y" style="height:100%;">
										<table class="slds-table slds-table_bordered slds-table_striped slds-table--header-fixed slds-table_col-bordered slds-table_fixed-layout" >
											<thead style="border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: black;">
												<tr>
													<th scope="col" style="width: {!widField}%; border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: black;">
														<div class="slds-truncate slds-cell-fixed slds-p-left_large" title="Object Name" style="width: {!widField}%;">
															<b>Object Name</b><br/>
															<apex:outputText value="{!expandObject}" escape="true"/><br/>
															<apex:outputText value="Display All" escape="true" rendered="{!expandObject != ''}" style="padding-left: {!10-selectedProfileIdList.size}rem; "/>
                                                            <apex:image value="{!URLFOR($Resource.HelpIconInGreen)}" rendered="{!expandObject != ''}" style="height: 15px; cursor: pointer;margin:5px;" title="Display all fields that are currently set to READ access or EDIT access"/>
                                                            <br/>
															<apex:outputText value="Tick All" escape="true" rendered="{!expandObject != ''}" style="padding-left: {!10-selectedProfileIdList.size}rem;"/>
                                                            <apex:image value="{!URLFOR($Resource.HelpIconInGreen)}" rendered="{!expandObject != ''}" style="height: 15px; cursor: pointer;margin:5px;" title="Check/Uncheck all Edit/Read checkboxes"/>
														</div>
													</th>
                                                    
                                                
													<apex:variable value="{!IF(selectedProfileIdList.size > 0, (100 - widField)/selectedProfileIdList.size, 70)}" var="index"/>
													<apex:variable var="i" value="{!0}" />
													<apex:repeat value="{!selectedProfileIdList}" var="pr">
                                                       
														<th scope="col" style="width: {!widField}%; border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: black; border-left-width: 1px; border-left-style: solid; border-left-color: lightgrey;">
															<div class="slds-align_absolute-center" style="width: {!index}%;">
																<div class="slds-cell-fixed" title="{!HTMLENCODE(profileNameMap[pr])}" id="profileName" style="width: {!index}%; text-align: center">
																	<span style="white-space: normal;">
																		<apex:outputlink value="/{!pr}" target="_blank">
																			<apex:outputText value="{!profileNameMap[pr]}" escape="true"  />
																		</apex:outputlink><br/>
																	</span>
                                                                    
																	<apex:outputPanel rendered="{!expandObject != ''}" layout="none">
																		<div class="demo-only demo-only--sizing slds-grid slds-wrap">
																			<div class="slds-p-horizontal_small slds-size_1-of-2">
																				<div class="slds-text-align_center">
																					<apex:outputText value="Read"/><br/>
																					<apex:inputCheckbox value="{!readProfileSelectCheckboxMap[pr]}" rendered="{!canChange}" title="Click this checkbox to display all fields that are currently set to READ access">
																						<apex:actionSupport event="onclick" action="{!readSelectOnlyRecordsWithSelectedCheckboxes}" rerender="profilesTable" status="tableStatus">
																							<apex:param name="SelectProfileId" value="{!pr}" assignTo="{!selectProfileId}"/>
																							<apex:param name="selectOnlySelectedCheckbox" value="{!If(readProfileSelectCheckboxMap[pr], false, true)}" assignTo="{!readSelectOnlySelectedCheckbox}"/>
																						</apex:actionSupport>
																					</apex:inputCheckbox>
																				</div>
																			</div>
																			<div class="slds-p-horizontal_small slds-size_1-of-2">
																				<div class="slds-text-align_center">
																					<apex:outputText value="Edit"/><br/>
																					<apex:inputCheckbox value="{!editProfileSelectCheckboxMap[pr]}" rendered="{!canChange}" title="Click this checkbox to display all fields that are currently set to EDIT access">
																						<apex:actionSupport event="onclick" action="{!editSelectOnlyRecordsWithSelectedCheckboxes}" rerender="profilesTable" status="tableStatus">
																							<apex:param name="SelectProfileId" value="{!pr}" assignTo="{!selectProfileId}"/>
																							<apex:param name="selectOnlySelectedCheckbox" value="{!If(editProfileSelectCheckboxMap[pr], false, true)}" assignTo="{!editSelectOnlySelectedCheckbox}"/>
																						</apex:actionSupport>
																					</apex:inputCheckbox>
																				</div>
																			</div>
																		</div>
																		<br/>
																		<div class="demo-only demo-only--sizing slds-grid slds-wrap">
																			<div class="slds-p-horizontal_small slds-size_1-of-2">
																				<div class="slds-text-align_center">
																					<apex:inputCheckbox onclick="selectAllCheckboxes(this, 'Read', '{!i}')" rendered="{!canChange}" id="readCheck" title="Click this checkbox to check/uncheck all Read checkboxes"/>
																				</div>
																			</div>
																			<div class="slds-p-horizontal_small slds-size_1-of-2">
																				<div class="slds-text-align_center">
																					<apex:inputCheckbox onclick="selectAllCheckboxes(this, 'Edit', '{!i}')" rendered="{!canChange}" id="editCheck" title="Click this checkbox to check/uncheck all Edit checkboxes"/>
																				</div>
																			</div>
																		</div>
																	</apex:outputPanel>
																</div>
															</div>
														</th>
														<apex:variable var="i" value="{!i+1}" />
													</apex:repeat>
												</tr>
											</thead>
											<tbody>
                                                   <tr>
                                                       <td scoped="col" style="width: {!widField}%" ><b>Type</b></td>
                                                       	<apex:repeat value="{!selectedProfileIdList}" var="pr">
                                                       <td scoped="col" class="slds-text-align_center" style="width: {!widField}%" >
                                                      {!IF(CONTAINS(pr,'00e'),'Profile','PermissionSet')}</td>
                                                       </apex:repeat>
                                                    </tr>
                                                    <apex:repeat value="{!objectPermisionWList}" var="opw">
													<tr>
														<td scoped="col" style="width: {!widField}%" data-label="{!opw.objLabel}">
															<div class="slds-truncate " title="{!opw.objLabel}">
																	<apex:outputText value="{!opw.objLabel}" escape="true"/> 
                                                                   
																	
																	<br/><apex:commandLink action="{!expandObjects}" reRender="profilesTable, errorSection, selectLog, buttonSection, excelbutton , expand-link" id="theCommandLink" status="tableStatus" style="font-size: xx-small;font-weight: 700;">
                                                                        Show/Hide FLS <apex:image value="{!URLFOR($Resource.HelpIconInGreen)}" style="height: 15px; margin-left: 2px;" title="Click on Object Name to expand Field Level Security"/>
																	 <apex:param name="expandObjectParam" value="{!opw.objName}" assignTo="{!expandObject}"/>
                                                                        </apex:commandLink>
                                                                     
																	<apex:outputPanel rendered="{!opw.objName == expandObject}">
																		
																	</apex:outputPanel>
																	<apex:outputPanel rendered="{!opw.objName != expandObject && expandObject != null && expandObject != ''}">
																		
																	</apex:outputPanel>
																
															</div>
														</td>
														<apex:repeat value="{!opw.objPermList}" var="p">
															<td style="width: {!index}%; border-left-width: 1px; border-left-style: solid; border-left-color: lightgrey;">
																<div class="slds-truncate slds-text-align_center" title="{!HTMLENCODE(opw.objLabel)} Permission">
																	{!p}
																</div>
															</td>
														</apex:repeat>
													</tr>
                                                    
													
													<apex:outputPanel rendered="{!expandObject == opw.objName && expandObject != ''}" layout="none" id="fieldSection">
														
														<apex:repeat value="{!fieldNameList}" var="field">
															<tr>
																<td style="width: {!widField}%;">
																	<div class="slds-p-left_xx-large slds-truncate"  title="{!fieldNameMap[field][0]}" style="white-space: normal;">
																							<p>
																								<apex:outputText value="{!fieldNameMap[field][0]}" escape="true"/>
																							</p>
																	</div>
																</td>
																<apex:variable var="i" value="{!0}" />
																<apex:repeat value="{!fieldPermissionMap[field]}" var="fpw">
																	<td style="width: {!index}%">
																		<div class="demo-only demo-only--sizing slds-grid slds-wrap">
																			<div class="slds-p-horizontal_small slds-size_1-of-2">
																				<div class="slds-truncate slds-text-align_center" title="{!fieldNameMap[field][0]} Read">
																					<div class="myClassRead{!i}">
																						<apex:inputCheckbox value="{!fpw.R}" disabled="{!IF(fieldNameMap[field][1] == 'false' || !canChange, true, false)}" id="readCheckID"/>
																					</div>
																				</div>
																			</div>
																			<div class="slds-p-horizontal_small slds-size_1-of-2">
																				<div class="slds-truncate slds-text-align_center" title="{!fieldNameMap[field][0]} Edit">
																					<div class="myClassEdit{!i}">
																						<apex:inputCheckbox value="{!fpw.E}" disabled="{!IF(fieldNameMap[field][1] == 'false' || !canChange, true, false)}" id="editCheckID"/>
																					</div>
																				</div>
																			</div>
																		</div>
																	</td>
																	<apex:variable var="i" value="{!i+1}" />
																</apex:repeat>
															</tr>
														</apex:repeat>
													</apex:outputPanel>
												</apex:repeat>
											</tbody>
										</table>
									</div>
								</div>
							</div>
						</div>
					</div>
				</apex:outputPanel>
		<!-- ----------------- Field Permission Table with LOG ------------- -->
				<apex:outputPanel rendered="{!selectedLog != '' && expandObject != ''}" layout="none">
					<div class="demo-only demo-only--sizing slds-grid slds-wrap">
						<div class="slds-scrollable_x" style="height: 100%; width: 100%;">
							<div class="slds-p-horizontal_small slds-size_1-of-1">
								<apex:variable value="{!IF(selectedProfileIdList.size > 3, 150, 100)}" var="wid"/>
								<apex:variable value="{!IF(selectedProfileIdList.size > 4, 12, 20)}" var="widField"/>
								<apex:variable value="{!IF(selectedProfileIdList.size > 5 , 200, wid)}" var="wid"/>
								<apex:variable value="{!IF(selectedProfileIdList.size > 4, 10, widField)}" var="widField"/>
								<div class="slds-table--header-fixed_container" style="height:450px; padding-top: 4rem; width: {!wid}%">
									<div class="slds-scrollable_y" style="height:100%;">
										
										<table class="slds-table slds-table_bordered slds-table_striped slds-table--header-fixed slds-table_col-bordered slds-table_fixed-layout">
											<thead>
												<tr>
													<th scoped="col" style="width: {!widField}%; border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: black;">
														<div class="slds-truncate slds-cell-fixed slds-p-left_large" title="Object Name" style="width: 30%">
															<b>Object Name</b><br/>
															<apex:outputText value="{!expandObject}" escape="true"/>
														</div>
													</th>
													<apex:variable value="{!IF(selectedProfileIdList.size > 0, (100 - widField)/selectedProfileIdList.size, 70)}" var="index"/>
													<apex:repeat value="{!selectedProfileIdList}" var="pr">
														<th scoped="col" style="border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: black;">
															<div class="slds-cell-fixed" title="{!HTMLENCODE(profileNameMap[pr])}" style="width: {!index}%">
																<div class="demo-only demo-only--sizing slds-grid slds-wrap" style="text-align: center; border-left-width: 1px; border-left-style: solid; border-left-color: lightgrey;">
																	<div class="slds-p-horizontal_small slds-size_1-of-1">
																		<apex:outputText value="{!profileNameMap[pr]}" escape="true"/>
																	</div>
																</div>
																<div class="demo-only demo-only--sizing slds-grid slds-wrap" style="text-align: center; border-left-width: 1px; border-left-style: solid; border-left-color: lightgrey;">
																	<div class="slds-p-horizontal_small slds-size_1-of-2">
																		<div class="slds-text-align_center">
																			<apex:outputText value="Read"/>
																		</div>
																	</div>
																	<div class="slds-p-horizontal_small slds-size_1-of-2" style="text-align: center; border-right-width: 1px; border-right-style: solid; border-right-color: lightgrey;">
																		<div class="slds-text-align_center">
																			<apex:outputText value="Edit"/>
																		</div>
																	</div>
																</div>
																<div class="demo-only demo-only--sizing slds-grid slds-wrap" style="border-left-width: 1px; border-left-style: solid; border-left-color: lightgrey;">
																	<div class="slds-p-horizontal_xx-small slds-size_1-of-4" style="text-align: right">
																		<apex:outputText value="Now" />
																	</div>
																	<div class="slds-p-horizontal_xx-small slds-size_1-of-4">
																		<apex:outputText value="Log" style="text-align: left"/>
																	</div>
																	<div class="slds-p-horizontal_xx-small slds-size_1-of-4" style="text-align: right">
																		<apex:outputText value="Now" />
																	</div>
																	<div class="slds-p-horizontal_xx-small slds-size_1-of-4">
																		<apex:outputText value="Log" style="text-align: left"/>
																	</div>
																</div>
															</div>
														</th>
													</apex:repeat>
												</tr>
											</thead>
											<tbody>
												<tr>
													<td data-label="Object Name" style="width: {!widField}%;">
														<apex:commandLink action="{!expandObjects}" reRender="profilesTable, errorSection, selectLog" id="theCommandLink" status="tableStatus">
															<apex:outputText value="{!expandObject}" escape="true"/>
															<apex:param name="expandObjectParam" value="{!expandObject}" assignTo="{!expandObject}"/>
															<span class="glyphicon glyphicon-triangle-top"></span>
														</apex:commandLink>
													</td>
													<apex:repeat value="{!objectPermisionWList[0].objPermList}" var="pr">
														<td style="width: {!index}%; text-align: center; border-left-width: 1px; border-left-style: solid; border-left-color: lightgrey;" data-label="Object Permission">
															<apex:outputText value="{!pr}"/>
														</td>
													</apex:repeat>
												</tr>
												<apex:repeat value="{!fieldNameList}" var="field">
													<tr>
														<td style="width: {!widField}%;">
															<div class="slds-p-left_xx-large slds-truncate" title="{!fieldNameMap[field][0]}" style="padding-left:50px; white-space: normal;">
																				<p >
																					<apex:outputText value="{!fieldNameMap[field][0]}" escape="true"/>
																				</p>
															</div>
														</td>
														<apex:repeat value="{!selectedProfileIdList}" var="prId">
															<td data-label="Field Permission" style="width: {!index}%;">
																<div class="demo-only demo-only--sizing slds-grid slds-wrap">
																	<div class="slds-p-horizontal_xx-small slds-size_1-of-4" style="background: {!IF(fielPermLogWMap[field][prId].R != fielPermLogWMap[field][prId].logR ,'#FFC7CE','')}">
																		<div class="slds-truncate slds-text-align_center" title="{!fieldNameMap[field][0]} Read">
																			<apex:inputCheckbox value="{!fielPermLogWMap[field][prId].R}" style="pointer-events: none;"/>
																		</div>
																	</div>
																	<div class="slds-p-horizontal_xx-small slds-size_1-of-4" style="background:{!IF(fielPermLogWMap[field][prId].R != fielPermLogWMap[field][prId].logR ,'#FFC7CE','')}">
																		<div class="slds-truncate slds-text-align_center" title="{!fieldNameMap[field][0]} LOG Read">
																			<apex:inputCheckbox value="{!fielPermLogWMap[field][prId].logR}" style="pointer-events: none;"/>
																		</div>
																	</div>
																	<div class="slds-p-horizontal_xx-small slds-size_1-of-4" style="background: {!IF(fielPermLogWMap[field][prId].E != fielPermLogWMap[field][prId].logE,'#FFC7CE','')}">
																		<div class="slds-truncate slds-text-align_center" title="{!fieldNameMap[field][0]} Edit">
																			<apex:inputCheckbox value="{!fielPermLogWMap[field][prId].E}" style="pointer-events: none;"/>
																		</div>
																	</div>
																	<div class="slds-p-horizontal_xx-small slds-size_1-of-4" style="background: {!IF(fielPermLogWMap[field][prId].E != fielPermLogWMap[field][prId].logE,'#FFC7CE','')}">
																		<div class="slds-truncate slds-text-align_center" title="{!fieldNameMap[field][0]} LOG Edit">
																			<apex:inputCheckbox value="{!fielPermLogWMap[field][prId].logE}" style="pointer-events: none;"/>
																		</div>
																	</div>
																</div>
															</td>
														</apex:repeat>
													</tr>
												</apex:repeat>
											</tbody>
										</table>
									</div>
								</div>
							</div>
						</div>
					</div>
				</apex:outputPanel>
			</apex:outputPanel>

			<apex:outputPanel id="tstpopup">
				<apex:outputPanel styleClass="popupBackground" layout="block" rendered="{!displayPopUp}"/>
				<apex:outputPanel styleClass="custPopup" layout="block" rendered="{!displayPopUp}" style="  width: 666px;">
					<c:MultiselectPicklist leftLabel="Available Profiles/Permission Sets."
						leftOption="{!profList}"
						leftOption1=""
						rightLabel="Selected Profiles/Permission Sets"
						rightOption="{!selectedProfileList}"
						size="8"
                         id="multiselect"
						width="180px"/>
					<apex:actionStatus id="popupStatus" layout="block">
						<apex:facet name="start">
							<p >
								<div class="slds-spinner_container slds-is-fixed">
									<div role="status" class="slds-spinner slds-spinner_large slds-spinner_brand">
										<span class="slds-assistive-text">Loading</span>
										<div class="slds-spinner__dot-a"></div>
										<div class="slds-spinner__dot-b"></div>
									</div>
								</div>
							</p>
						</apex:facet>
						<apex:facet name="stop"></apex:facet>
					</apex:actionStatus>
					<apex:outputPanel id="erorrMessage">
						<apex:pageMessages />
					</apex:outputPanel>
					<div style="text-align: center">
						<br/>
						<apex:commandButton value="Export to Excel" action="{!SelectProfilesForExportToExcel}" rerender="tstpopup, erorrMessage, {!If(!displayPopup, 'exportToExcel', '')}" status="popupStatus"  style=" width: inherit; appearance: button; background-color: #8694f4;background-image: linear-gradient(to bottom, #fff, #eceae787);border: 1px solid #d4d2d2;border-radius: 0.5rem;box-sizing: border-box;color: #444444;column-gap: 1rem;cursor: pointer; font-family: ui-sans-serif,system-ui,-apple-system,system-ui,&quot;Segoe UI&quot;,Roboto,&quot;Helvetica Neue&quot;,Arial,&quot;Noto Sans&quot;,sans-serif,&quot;Apple Color Emoji&quot;,&quot;Segoe UI Emoji&quot;,&quot;Segoe UI Symbol&quot;,&quot;Noto Color Emoji&quot;;font-size: 100%;flex: 1;font-weight: 700;line-height: 13px;margin: 3px;outline: 2px solid transparent;padding: 0.6rem 1.5rem;text-align: center;text-transform: none;transition: all .1s cubic-bezier(.4, 0, .2, 1);-webkit-user-select: none;-moz-user-select: none;-ms-user-select: none;user-select: none;touch-action: manipulation;box-shadow: -6px 8px 10px rgb(81 41 10 / 11%), 0 2px 2px rgb(81 41 10 / 10%);" styleClass="slds-button slds-button_success"/>
						<apex:commandButton value="Cancel" action="{!closePopup}" rerender="tstpopup, theForm" status="popupStatus" style=" width: inherit; appearance: button; background-color: #8694f4;background-image: linear-gradient(to bottom, #fff, #eceae787);border: 1px solid #d4d2d2;border-radius: 0.5rem;box-sizing: border-box;color: #444444;column-gap: 1rem;cursor: pointer; font-family: ui-sans-serif,system-ui,-apple-system,system-ui,&quot;Segoe UI&quot;,Roboto,&quot;Helvetica Neue&quot;,Arial,&quot;Noto Sans&quot;,sans-serif,&quot;Apple Color Emoji&quot;,&quot;Segoe UI Emoji&quot;,&quot;Segoe UI Symbol&quot;,&quot;Noto Color Emoji&quot;;font-size: 100%;flex: 1;font-weight: 700;line-height: 13px;margin: 3px;outline: 2px solid transparent;padding: 0.6rem 1.5rem;text-align: center;text-transform: none;transition: all .1s cubic-bezier(.4, 0, .2, 1);-webkit-user-select: none;-moz-user-select: none;-ms-user-select: none;user-select: none;touch-action: manipulation;box-shadow: -6px 8px 10px rgb(81 41 10 / 11%), 0 2px 2px rgb(81 41 10 / 10%);" styleClass="slds-button slds-button_destructive"/>
					</div>
				</apex:outputPanel>
				<apex:outputPanel id="exportToExcel" rendered="{!selectedProfileList.size > 0 && readyToExport}">
					<script>
						callBackFunctionExportToExcel();
					</script>
				</apex:outputPanel>
				<apex:actionFunction action="{!ExportToExcel}" name="callBackFunctionExportToExcel"/>
			</apex:outputPanel>
			
			
		</div>
        </apex:outputPanel>
		</apex:form>
    
	<p style="text-align: center; font-size: 10px; font-weight: bold;">Security &amp; Access Manager Functionality Copyright  2017, Application Perfection Ltd.</p> 
	<p style="text-align: center; font-size: 10px; font-weight: bold;">All rights reserved.</p>



		<script type="text/javascript">
    
     window.addEventListener('load', function() {
        // Get the current URL
        var currentURL = window.location.href;
        console.log("Current URL:", currentURL); // Debugging line
        
        // Check if the URL contains 'ObjectsAndFieldsAccess'
        if (currentURL.includes("ObjectsAndFieldsAccess")) {
            console.log("URL includes 'ObjectsAndFieldsAccess'.");
            var tabname = 'ObjectsAndFieldsAccess';
            localStorage.setItem("tabname", tabname); // Set 'tabname' in localStorage
            console.log("Set tabname to 'ObjectsAndFieldsAccess'."); // Debugging line
        }
         //   renderDivIfObjectAccess();
         OAFloadDropdown();
    });
        
    
    function selectAllCheckboxes(obj, perm, index){
			console.log('index::' + index);
			console.log('obj.checked::' + obj.checked);
			var myClass = 'myClass' + perm + index;
			console.log('myClass::' + myClass);
			var check = document.querySelectorAll('.' + myClass);
			console.log('check ::' + check.length);
			console.log('inputCheckBox::' + check[0].childNodes[0].checked);
			for(var i = 0; i < check.length; i++){
				if(check[i].childNodes[0].disabled === false) {
					check[i].childNodes[0].checked = obj.checked;
				} else {
					console.log('term' + i + '::' + check[i].childNodes[0].disabled);
				}
			}
		}
    
    function expandForm() {
        var outputPanel = document.querySelector(".selectOptions2");
        var outputPanel2 = document.querySelector(".otherClass");
        var outputPanel3 = document.querySelector(".buts");
        
        var displayProperty = window.getComputedStyle(outputPanel).display;
          var displayProperty2 = window.getComputedStyle(outputPanel2).display;
         var displayProperty3 = window.getComputedStyle(outputPanel3).display;
        
        console.log({outputPanel,outputPanel2,outputPanel3,displayProperty});
        if (outputPanel && outputPanel2 && outputPanel3) {
            outputPanel.style.display = displayProperty === 'none' ? 'unset' : "none"; 
            outputPanel2.style.display = displayProperty2 === 'none' ? 'unset' : "none"; 
             outputPanel3.style.display = displayProperty3 === 'none' ? 'flex' : "none";
         }
     }
                    
    
		
	
	</script>
	</body>
</apex:outputPanel>
<apex:outputPanel rendered="{!NOT(hasAccess)}">
 <div style="text-align: center; margin-top: 100px;">
            <h1 style="text-align:center; font-family:verdana; color:red;">
                Sorry, you do not have access to Objects And Fields Access.
            </h1>
            <p style="text-align:center; font-family:verdana;">
                It looks like your current subscription does not include access to Objects And Fields Access. To gain access, please purchase the feature by contacting our support team or visiting our [website](<a href="https://applicationperfection.com/contact/">ApplicationPerfection.com</a>). If you believe you should have access, please reach out to support for assistance.
            </p>
        </div>
</apex:outputPanel>
	
</apex:page>